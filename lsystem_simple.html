<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>L-System Demo</title>
<style>
  body { margin:0; background:#222244; overflow:hidden; }
  canvas { display:block; width:100vw; height:100vh; background:#333322; }
  button {
    position:absolute; top:8px; left:8px;
    background:green; color:#ffffee; border:none;
    padding:6px 10px; font-size:14px; cursor:pointer;
  }
</style>
</head>
<body>
<canvas id="c"></canvas>
<button onclick="next()">Next Pattern</button>
<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
let w, h;
function resize() { w = canvas.width = innerWidth; h = canvas.height = innerHeight; }
window.onresize = resize;
resize();

// Define several simple L-systems
const systems = [
  {
    axiom: "F",
    rules: { "F": "F+F−F−F+F" }, // Koch curve variant
    angle: 90, iterations: 4, dist: 5
  },
  {
    axiom: "X",
    rules: { "X": "F+[[X]-X]-F[-FX]+X", "F": "FF" }, // classic plant
    angle: 25, iterations: 5, dist: 4
  },
  {
    axiom: "F−F−F−F",
    rules: { "F": "F−F+F+FF−F−F+F" }, // another fractal
    angle: 90, iterations: 3, dist: 6
  }
];

let current = 0;

// Generate L-system string
function generate(sys) {
  let str = sys.axiom;
  for (let i=0;i<sys.iterations;i++) {
    let next="";
    for (const ch of str) next += sys.rules[ch] || ch;
    str = next;
  }
  return str;
}

// Draw using turtle graphics
function drawLSystem(str, angle, dist) {
  ctx.clearRect(0,0,w,h);
  ctx.save();
  ctx.strokeStyle="#ffffee";
  ctx.lineWidth=1;
  ctx.translate(w/2, h);
  ctx.beginPath();
  let stack=[];
  let a=-90;
  for (const ch of str) {
    if (ch==="F") {
      const x2=Math.cos(a*Math.PI/180)*dist;
      const y2=Math.sin(a*Math.PI/180)*dist;
      ctx.lineTo(x2, y2);
      ctx.translate(x2, y2);
    } else if (ch==="+") a += angle;
    else if (ch==="−" || ch==="-") a -= angle;
    else if (ch==="[") stack.push([ctx.getTransform(), a]);
    else if (ch==="]") {
      ctx.setTransform(stack.at(-1)[0]);
      a=stack.pop()[1];
      ctx.moveTo(0,0);
    }
  }
  ctx.stroke();
  ctx.restore();
}

function next() {
  const sys = systems[current];
  const str = generate(sys);
  drawLSystem(str, sys.angle, sys.dist);
  current = (current+1) % systems.length;
}

next();
</script>
</body>
</html>
